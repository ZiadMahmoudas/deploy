import{a as V}from"./chunk-V6KGQEPR.js";import{a as A,b as F,c as q,d as z,e as D,g as Y,h as j,i as L,j as B,k as G,l as Q}from"./chunk-NQUXY33H.js";import{r as N}from"./chunk-EMUXDAZT.js";import{Aa as P,Ab as I,Ba as g,Bb as T,Ga as x,Ha as k,I as f,Ia as v,J as w,Ka as b,Ma as a,Na as M,P as C,Ta as R,Z as r,ca as m,cb as y,ea as O,oa as d,pa as l,sa as c,ta as i,ua as s,va as u,ya as E,yb as S}from"./chunk-QQJZZCOM.js";function H(o,n){return e=>{let t=e.get(o)?.value,p=e.get(n)?.value;return t===p?null:(e.get(n)?.setErrors({passwordMismatch:!0}),{passwordMismatch:!0})}}var J=["passwordInput"],K=["confirmPasswordField"],W=()=>["/login"];function X(o,n){o&1&&(i(0,"span"),a(1,"Password is required."),s())}function Z(o,n){o&1&&(i(0,"span"),a(1,"Password must be at least 8 characters, with uppercase, lowercase, number, and special character."),s())}function $(o,n){if(o&1&&(i(0,"div",9),d(1,X,2,0,"span")(2,Z,2,0,"span"),s()),o&2){let e=g();r(),l(e.newPassword.errors!=null&&e.newPassword.errors.required?1:e.newPassword.errors!=null&&e.newPassword.errors.pattern?2:-1)}}function ee(o,n){o&1&&(i(0,"span"),a(1,"Confirm Password is required."),s())}function te(o,n){if(o&1&&(i(0,"div",9),d(1,ee,2,0,"span"),s()),o&2){let e=g();r(),l(e.confirmPassword.errors!=null&&e.confirmPassword.errors.required?1:-1)}}function oe(o,n){o&1&&(i(0,"small",9),a(1,"Passwords do not match."),s())}function ne(o,n){o&1&&(i(0,"small",13),a(1,"Passwords match."),s())}function re(o,n){if(o&1&&(i(0,"div",14),a(1),s()),o&2){let e=g();r(),M(e.errorMessage)}}function ie(o,n){if(o&1&&(i(0,"div",15),a(1),s()),o&2){let e=g();r(),M(e.successMessage)}}function se(o,n){o&1&&(u(0,"span",21),i(1,"span",22),a(2,"Recovering..."),s())}function ae(o,n){o&1&&a(0," Recover Password ")}var U=class o{constructor(n,e,t,p,h){this.FB=n;this.route=e;this.auth=t;this.router=p;this.toastr=h;this.ForgetForm=this.FB.group({newPassword:["",F.required],confirmPassword:["",F.required]},{validator:H("newPassword","confirmPassword")})}isEyeOpen=C(!0);passwordInputRef=y("passwordInput");confirmPasswordField=y("confirmPasswordField");isConfirmPasswordEyeOpen=C(!0);loading=!1;errorMessage=null;successMessage=null;token=null;togglePasswordEye(n){this.isEyeOpen.update(e=>{let t=!e;return n.type=t?"text":"password",t})}toggleConfirmPasswordEye(n){this.isConfirmPasswordEyeOpen.update(e=>{let t=!e;return n.type=t?"text":"password",t})}ForgetForm=new D({});get confirmPassword(){return this.ForgetForm.controls.confirmPassword}get newPassword(){return this.ForgetForm.controls.newPassword}ngOnInit(){this.route.queryParams.subscribe(n=>{this.token=n.token}),setTimeout(()=>{this.passwordInputRef()&&this.togglePasswordEye(this.passwordInputRef().nativeElement),this.confirmPasswordField()&&this.toggleConfirmPasswordEye(this.confirmPasswordField().nativeElement)},0),this.ForgetForm.statusChanges.subscribe(n=>{this.ForgetForm.get("confirmPassword")?.touched&&!this.ForgetForm.hasError("passwordMismatch")?(this.successMatch=!0,setTimeout(()=>{this.successMatch=!1},3e3)):this.successMatch=!1})}onsubmit(){if(this.ForgetForm.invalid){this.ForgetForm.markAllAsTouched(),this.toastr.warning("Please Enter All Fields"),this.errorMessage="Please fix the errors in the form.";return}if(!this.token){this.toastr.error("Password reset token is missing. Please request a new link.");return}this.loading=!0;let n={token:this.token,newPassword:this.ForgetForm.value.newPassword,confirmPassword:this.ForgetForm.value.confirmPassword};this.auth.submitNewPassword(n).subscribe({next:e=>{this.toastr.success("Password updated successfully! You can check your email to get password"),setTimeout(()=>{this.router.navigate(["/login"])},4e3),this.loading=!1},error:e=>{this.loading=!1,e.error&&e.error.message?this.errorMessage=e.error.message:e.status===400?this.toastr.error("Invalid or expired password reset token. Please request a new one."):e.status===401?this.toastr.error("Unauthorized: Please check your token."):this.toastr.error("An unexpected error occurred. Please try again.")}})}successMatch=!1;static \u0275fac=function(e){return new(e||o)(m(G),m(S),m(V),m(I),m(N))};static \u0275cmp=O({type:o,selectors:[["app-reset-password"]],viewQuery:function(e,t){e&1&&(x(t.passwordInputRef,J,5),x(t.confirmPasswordField,K,5)),e&2&&k(2)},decls:32,vars:22,consts:[["passwordInput",""],["confirmPasswordField",""],[1,"fullScreen","mb-5"],[1,"signup-container"],[3,"ngSubmit","formGroup"],[1,"input-group","password-toggle"],["for","password"],["formControlName","newPassword","id","password","name","password","placeholder","Please Enter Your new password","required","",3,"type"],[1,"fa-duotone","fa-light","fa-eye","toggle-password",3,"click"],[1,"text-danger"],["for","confirm-password"],["formControlName","confirmPassword","id","confirm-password","name","confirm-password","placeholder","Confirm New Password","required","",3,"type"],[1,"fa-duotone","fa-light","toggle-password",3,"click"],[1,"text-success"],[1,"alert","alert-danger","mt-3"],[1,"alert","alert-success","mt-3"],[1,"btn","btn-primary",3,"disabled"],[1,"d-flex","align-items-center","gap-1","mt-3",3,"routerLink"],[1,"fa-solid","fa-arrow-left"],[1,"social-signup"],[1,"social-button","justify-content-center","mb-3","mt-3",3,"routerLink"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"ms-2"]],template:function(e,t){if(e&1){let p=E();i(0,"div",2)(1,"div",3)(2,"h2"),a(3,"Recover Your Password"),s(),i(4,"form",4),P("ngSubmit",function(){return f(p),w(t.onsubmit())}),i(5,"div",5)(6,"label",6),a(7,"New Password"),s(),u(8,"input",7,0),i(10,"i",8),P("click",function(){f(p);let _=v(9);return w(t.togglePasswordEye(_))}),s()(),d(11,$,3,1,"div",9),i(12,"div",5)(13,"label",10),a(14,"Confirm New Password"),s(),u(15,"input",11,1),i(17,"i",12),P("click",function(){f(p);let _=v(16);return w(t.toggleConfirmPasswordEye(_))}),s()(),d(18,te,2,1,"div",9),d(19,oe,2,0,"small",9),d(20,ne,2,0,"small",13),d(21,re,2,1,"div",14),d(22,ie,2,1,"div",15),i(23,"button",16),d(24,se,3,0)(25,ae,1,0),s()(),i(26,"a",17),u(27,"i",18),a(28," Back to Forget Password "),s(),i(29,"div",19)(30,"a",20),a(31," Login "),s()()()()}e&2&&(r(4),c("formGroup",t.ForgetForm),r(4),c("type",t.isEyeOpen()?"text":"password"),r(2),b("fa-eye",t.isEyeOpen())("fa-eye-slash",!t.isEyeOpen()),r(),l(t.newPassword.invalid&&t.newPassword.touched?11:-1),r(4),c("type",t.isConfirmPasswordEyeOpen()?"text":"password"),r(2),b("fa-eye",t.isConfirmPasswordEyeOpen())("fa-eye-slash",!t.isConfirmPasswordEyeOpen()),r(),l(t.confirmPassword.invalid&&t.confirmPassword.touched?18:-1),r(),l(t.ForgetForm.hasError("passwordMismatch")&&t.ForgetForm.touched?19:-1),r(),l(t.successMatch&&!t.ForgetForm.hasError("passwordMismatch")&&t.ForgetForm.touched?20:-1),r(),l(t.errorMessage?21:-1),r(),l(t.successMessage?22:-1),r(),c("disabled",t.loading||t.ForgetForm.invalid),r(),l(t.loading?24:25),r(2),c("routerLink","/forgetPassword"),r(4),c("routerLink",R(21,W)))},dependencies:[Q,Y,A,q,z,B,j,L,T],styles:['.fullScreen[_ngcontent-%COMP%]{font-family:Cairo,sans-serif;background:linear-gradient(to right,#6a11cb,#2575fc);display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;color:#333}.password-toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:12px 40px 12px 10px;border:1px solid #ddd;border-radius:8px;font-size:1em;transition:border-color .3s ease,box-shadow .3s ease;box-sizing:border-box}.password-toggle[_ngcontent-%COMP%]   .toggle-password[_ngcontent-%COMP%]{position:absolute;top:71%;right:32px;transform:translateY(-71%);cursor:pointer;color:#aaa;font-size:1.1em;transition:color .3s ease}.password-toggle[_ngcontent-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover{color:#666}.signup-container[_ngcontent-%COMP%]{background-color:#fff;padding:40px;border-radius:15px;box-shadow:0 10px 30px #0003;width:100%;max-width:450px;text-align:center;animation:_ngcontent-%COMP%_fadeIn .8s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:25px;font-size:2em;position:relative}h2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-10px;left:50%;transform:translate(-50%);width:60px;height:4px;background-color:#2575fc;border-radius:2px}.input-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:right}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:8px;font-weight:600;color:#555;font-size:.95em}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:12px 10px;border:1px solid #ddd;border-radius:8px;font-size:1em;transition:border-color .3s ease,box-shadow .3s ease}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#2575fc;box-shadow:0 0 0 3px #2575fc33;outline:none}.input-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:red;box-shadow:0 0 0 3px #d6040433;outline:none}.input-group[_ngcontent-%COMP%]   input.success[_ngcontent-%COMP%]{border-color:#0f0;box-shadow:0 0 0 3px #03e21533;outline:none}.password-toggle[_ngcontent-%COMP%]{position:relative}.password-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{position:absolute;left:10px;top:50%;transform:translateY(-50%);cursor:pointer;color:#aaa;font-size:1.1em;transition:color .3s ease}.password-toggle[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]:hover{color:#666}button[_ngcontent-%COMP%]{background-color:#2575fc;color:#fff;padding:15px 30px;border:none;border-radius:8px;font-size:1.1em;font-weight:600;cursor:pointer;transition:background-color .3s ease,transform .2s ease;width:100%;margin-top:20px}button[_ngcontent-%COMP%]:hover{background-color:#1a5acb;transform:translateY(-2px)}.social-signup[_ngcontent-%COMP%]{margin-top:25px;border-top:1px solid #eee;padding-top:25px}.social-signup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:15px;font-size:.9em}.social-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px}.social-button[_ngcontent-%COMP%]{background-color:#f4f4f4;border:1px solid #ddd;padding:12px 20px;border-radius:8px;cursor:pointer;transition:background-color .3s ease,transform .2s ease;display:flex;align-items:center;gap:8px;font-size:.9em;color:#444;text-decoration:none}.social-button[_ngcontent-%COMP%]:hover{background-color:#e9e9e9;transform:translateY(-2px)}.social-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px}.login-link[_ngcontent-%COMP%]{margin-top:25px;font-size:.9em;color:#666}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#2575fc;text-decoration:none;font-weight:600;transition:color .3s ease}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1a5acb;text-decoration:underline}']})};export{U as ResetPassword};
