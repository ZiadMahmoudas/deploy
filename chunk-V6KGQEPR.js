import{a as u,c as g,r as l}from"./chunk-EMUXDAZT.js";import{Ab as m,C as i,F as s,f as a,rb as c,sb as p,tb as h}from"./chunk-QQJZZCOM.js";var n=class r{constructor(e){this.storage=e}accessTokenKey="accessToken";setAccessToken(e){localStorage.setItem(this.accessTokenKey,e)}getAccessToken(){return localStorage.getItem(this.accessTokenKey)}clearAccessToken(){localStorage.removeItem(this.accessTokenKey)}get(e){return this.storage.getItem(e)}set(e,t){this.storage.setItem(e,t)}remove(e){this.storage.removeItem(e)}static \u0275fac=function(t){return new(t||r)(s(g))};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};var k=class r{constructor(e,t,o,v,d){this.http=e;this.tokenService=t;this.baseURL=o;this.router=v;this.toastr=d}login(e){return new a(t=>{this.http.post(`${this.baseURL}Auth/login`,e,{withCredentials:!0}).subscribe({next:o=>{this.tokenService.setAccessToken(o.accessToken),t.next(o),t.complete()},error:o=>{t.error(o)}})})}refreshToken(){return new a(e=>{this.http.post(`${this.baseURL}Auth/refresh`,{},{withCredentials:!0}).subscribe({next:t=>{this.tokenService.setAccessToken(t.accessToken),e.next(t.accessToken),e.complete()},error:t=>{e.error(t)}})})}saveNewTokens(e){this.tokenService.setAccessToken(e.accessToken)}getAccessToken(){return this.tokenService.getAccessToken()}removeAccessToken(){this.tokenService.clearAccessToken()}logout(){return this.http.post(`${this.baseURL}Auth/logout`,{},{withCredentials:!0,headers:new c({Authorization:"Bearer "+this.tokenService.getAccessToken()})})}forgetPassword(e){return this.http.post(`${this.baseURL}Forget/forget-password`,e,{withCredentials:!0,responseType:"text"})}submitNewPassword(e){return this.http.post(`${this.baseURL}Forget/submit-new-password`,e,{withCredentials:!0,responseType:"text"})}confirmPasswordChange(e,t){let o=new p().set("token",e).set("action",t);return this.http.get(`${this.baseURL}Forget/confirm-password-change`,{params:o,withCredentials:!0})}handlePasswordChangeResponse(e){e.success?(this.toastr.success("Your password has been changed successfully."),setTimeout(()=>{this.router.navigate(["/login"])},4e3)):(this.toastr.info("No changes were made to your password."),setTimeout(()=>{this.router.navigate(["/login"])},4e3))}Contact(e){return this.http.post(`${this.baseURL}Contact/send`,e,{withCredentials:!0})}static \u0275fac=function(t){return new(t||r)(s(h),s(n),s(u),s(m),s(l))};static \u0275prov=i({token:r,factory:r.\u0275fac,providedIn:"root"})};export{k as a};
